<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute a Geometric Mean — geometric_mean • ggsurveillance</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute a Geometric Mean — geometric_mean"><meta name="description" content="The geometric mean is typically defined for strictly positive values.
This function computes the geometric mean of a numeric vector,
with the option to replace certain values (e.g., zeros, non-positive values,
or values below a user-specified threshold) before computation."><meta property="og:description" content="The geometric mean is typically defined for strictly positive values.
This function computes the geometric mean of a numeric vector,
with the option to replace certain values (e.g., zeros, non-positive values,
or values below a user-specified threshold) before computation."><meta property="og:image" content="https://ggsurveillance.biostats.dev/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggsurveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/align_dates_seasonal.html">Seasonal Plots: Align case data for seasonal analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Epicurves_with_ggsurveillance.html">EpiCurves: epicurves in ggplot with ggsurveillance</a></li>
    <li><a class="dropdown-item" href="../articles/Epigantt_with_ggsurveillance.html">EpiGantt: epigantt charts in ggplot with ggsurveillance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biostats-dev/ggsurveillance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Compute a Geometric Mean</h1>
      <small class="dont-index">Source: <a href="https://github.com/biostats-dev/ggsurveillance/blob/main/R/geometric_mean.R" class="external-link"><code>R/geometric_mean.R</code></a></small>
      <div class="d-none name"><code>geometric_mean.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The geometric mean is typically defined for strictly positive values.
This function computes the geometric mean of a numeric vector,
with the option to replace certain values (e.g., zeros, non-positive values,
or values below a user-specified threshold) before computation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">geometric_mean</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  replace_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"non-positive"</span>, <span class="st">"zero"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric or complex vector of values.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical. If <code>FALSE</code> (default), the presence of zero or
negative values triggers a warning and returns <code>NA</code>. If <code>TRUE</code>,
such values (and any <code>NA</code>) are removed before computing the geometric mean.</p></dd>


<dt id="arg-replace-value">replace_value<a class="anchor" aria-label="anchor" href="#arg-replace-value"></a></dt>
<dd><p>Numeric or <code>NULL</code>. The value used for replacement,
depending on <code>replace</code> (e.g., a detection limit (LOD) or quantification limit (LOQ)).
If <code>NULL</code>, no replacement is performed. For recommendations how to use, see details.</p></dd>


<dt id="arg-replace">replace<a class="anchor" aria-label="anchor" href="#arg-replace"></a></dt>
<dd><p>Character string indicating which values to replace:</p><dl><dt><code>"all"</code></dt>
<dd><p>Replaces all values less than <code>replace_value</code>
with <code>replace_value</code>. This is useful if you have a global threshold
(such as a limit of detection) below which any measurement is replaced.</p></dd>

<dt><code>"non-positive"</code></dt>
<dd><p>Replaces all non-positive values (<code>x &lt;= 0</code>)
with <code>replace_value</code>. This is helpful if zeros or negative values
are known to be invalid or below a certain limit.</p></dd>

<dt><code>"zero"</code></dt>
<dd><p>Replaces only exact zeros (<code>x == 0</code>) with
<code>replace_value</code>. Useful if negative values should be treated as missing.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A single numeric value representing the geometric mean of the
processed vector <code>x</code>, or <code>NA</code> if the resulting vector is empty
(e.g., if <code>na.rm = TRUE</code> removes all positive values) or if non-positive
values exist when <code>na.rm = FALSE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Replacement Considerations</strong>:
The geometric mean is only defined for strictly positive numbers (\(x &gt; 0\)). Despite this, the geometric mean can be
useful for laboratory measurements which can contain 0 or negative values. If these values are treated as NA
and are removed, this results in an upward bias due to missingness. To reduce this, values below the
limit of detection (LOD) or limit of quantification (LOQ) are often replaced with the chosen limit,
making this limit the practical lower limit of the measurement scale.
This is therefore an often recommended approach.</p>
<p>There are also alternatives approaches, where values are replaced by
either \(\frac{LOD}{2}\) or \(\frac{LOD}{\sqrt{2}}\) (or LOQ). These approaches create a gap in the distribution
of values (e.g. no values for \(\frac{LOD}{2} &lt; x &lt; LOD\)) and should therefore be used with caution.</p>
<p><strong>If the replacement approach for values below LOD or LOQ has a material effect on the
interpretation of the results, the values should be treated as statistically censored. In this case,
proper statistical methods to handle (left) censored data should be used.</strong></p>
<p>When <code>replace_value</code> is provided, the function will <em>first</em> perform
the specified replacements, then proceed with the geometric mean calculation.
If no replacements are requested but zero or negative values remain and
<code>na.rm = FALSE</code>, an <code>NA</code> will be returned with a warning.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic usage with no replacements:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">geometric_mean</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.605171</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Replace all values &lt; 0.5 with 0.5 (common in LOD scenarios):</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">geometric_mean</span><span class="op">(</span><span class="va">x3</span>, replace_value <span class="op">=</span> <span class="fl">0.5</span>, replace <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 values were substituted with 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9102821</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove zero or negative values, since log(0) = -Inf and log(-1) = NaN</span></span></span>
<span class="r-in"><span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">geometric_mean</span><span class="op">(</span><span class="va">x4</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.817121</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ndevln" class="external-link">Alexander Bartel</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

