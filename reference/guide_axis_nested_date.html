<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nested axis guide for date scales — guide_axis_nested_date • ggsurveillance</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nested axis guide for date scales — guide_axis_nested_date"><meta name="description" content="A specialized axis guide for date scales that creates nested axis labels
by automatically detecting hierarchical patterns in date labels (e.g.,
separating day-month from year components). This guide is particularly
useful for time series data, where the axis can get crowded when
showing the full dates. This is similar to the date scale from Excel."><meta property="og:description" content="A specialized axis guide for date scales that creates nested axis labels
by automatically detecting hierarchical patterns in date labels (e.g.,
separating day-month from year components). This guide is particularly
useful for time series data, where the axis can get crowded when
showing the full dates. This is similar to the date scale from Excel."><meta property="og:image" content="https://ggsurveillance.biostats.dev/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggsurveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/align_dates_seasonal.html">Seasonal Plots: Align case data for seasonal analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Epicurves_with_ggsurveillance.html">EpiCurves: epicurves in ggplot with ggsurveillance</a></li>
    <li><a class="dropdown-item" href="../articles/Epigantt_with_ggsurveillance.html">EpiGantt: epigantt charts in ggplot with ggsurveillance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biostats-dev/ggsurveillance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Nested axis guide for date scales</h1>
      <small class="dont-index">Source: <a href="https://github.com/biostats-dev/ggsurveillance/blob/main/R/guide_axis_nested_date.R" class="external-link"><code>R/guide_axis_nested_date.R</code></a></small>
      <div class="d-none name"><code>guide_axis_nested_date.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A specialized axis guide for date scales that creates nested axis labels
by automatically detecting hierarchical patterns in date labels (e.g.,
separating day-month from year components). This guide is particularly
useful for time series data, where the axis can get crowded when
showing the full dates. This is similar to the date scale from Excel.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">guide_axis_nested_date</span><span class="op">(</span></span>
<span>  sep <span class="op">=</span> <span class="st">"[^[:alnum:]]+"</span>,</span>
<span>  regular_key <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"bracket"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>  pad_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oob <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>A regular expression pattern used to split axis labels into
hierarchical components. Default is <code>"[^[:alnum:]]+"</code> which splits on
non-alphanumeric characters.</p></dd>


<dt id="arg-regular-key">regular_key<a class="anchor" aria-label="anchor" href="#arg-regular-key"></a></dt>
<dd><p>Default is <code>"auto"</code>, which generates the nested axis based on the date labels and the separator above.
This option can be used to provide your own specification for the nested key. See <code><a href="https://teunbrand.github.io/legendry/reference/key_standard.html" class="external-link">legendry::key_standard()</a></code></p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The visual type of nested axis guide to create. Options include:</p><ul><li><p><code>"bracket"</code> (default): Creates bracket-style nested labels</p></li>
<li><p><code>"fence"</code>: Creates fence-style nested labels (like Excel)</p></li>
<li><p><code>"box"</code>: Creates box-style nested labels</p></li>
</ul></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Processing mode for the guide. Default is <code>"simple"</code>. Currently, this is the only supported mode.</p></dd>


<dt id="arg-pad-date">pad_date<a class="anchor" aria-label="anchor" href="#arg-pad-date"></a></dt>
<dd><p>Numeric value controlling the padding around date levels,
i.e. extending the length of the bracket or box or for correctly positioning the fences.
If <code>NULL</code> (default), automatically sets to 0.5 for "fence" type and
0.25 for other types.</p></dd>


<dt id="arg-oob">oob<a class="anchor" aria-label="anchor" href="#arg-oob"></a></dt>
<dd><p>How to handle out-of-bounds values of the scale labels. Default is <code>"none"</code>.
Another option is <code>"squish"</code>, but this can result in overlapping labels.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://teunbrand.github.io/legendry/reference/guide_axis_nested.html" class="external-link">legendry::guide_axis_nested()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A nested axis guide object that can be used with <code><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">ggplot2::scale_x_date()</a></code> etc. or <code><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">ggplot2::guides()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://teunbrand.github.io/legendry/reference/guide_axis_nested.html" class="external-link">legendry::guide_axis_nested()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create sample epidemic curve data</span></span></span>
<span class="r-in"><span><span class="va">epi_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-15"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">101</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">epi_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_epicurve.html">geom_epicurve</a></span><span class="op">(</span>date_resolution <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    date_breaks <span class="op">=</span> <span class="st">"2 weeks"</span>, date_labels <span class="op">=</span> <span class="st">"%d-%b-%Y"</span>,</span></span>
<span class="r-in"><span>    guide <span class="op">=</span> <span class="fu">guide_axis_nested_date</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="guide_axis_nested_date-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using fence type with ISO week labels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">epi_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_epicurve.html">geom_epicurve</a></span><span class="op">(</span>date_resolution <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    date_breaks <span class="op">=</span> <span class="st">"2 weeks"</span>, date_labels <span class="op">=</span> <span class="st">"W%V.%G"</span>,</span></span>
<span class="r-in"><span>    guide <span class="op">=</span> <span class="fu">guide_axis_nested_date</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"fence"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="guide_axis_nested_date-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using box type with custom padding</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">epi_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_epicurve.html">geom_epicurve</a></span><span class="op">(</span>date_resolution <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, date_labels <span class="op">=</span> <span class="st">"%b.%Y"</span>,</span></span>
<span class="r-in"><span>    guide <span class="op">=</span> <span class="fu">guide_axis_nested_date</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"box"</span>, pad_date <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="guide_axis_nested_date-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom separator for different label formats</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">epi_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_epicurve.html">geom_epicurve</a></span><span class="op">(</span>date_resolution <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    date_breaks <span class="op">=</span> <span class="st">"1 week"</span>, date_labels <span class="op">=</span> <span class="st">"%d-%b-%Y"</span>,</span></span>
<span class="r-in"><span>    guide <span class="op">=</span> <span class="fu">guide_axis_nested_date</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"bracket"</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="guide_axis_nested_date-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Datetime example with fence type</span></span></span>
<span class="r-in"><span><span class="va">datetime_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  datetime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2024-02-05 01:00:00"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">50</span> <span class="op">*</span> <span class="fl">3600</span>,</span></span>
<span class="r-in"><span>    times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">51</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">datetime_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_epicurve.html">geom_epicurve</a></span><span class="op">(</span>date_resolution <span class="op">=</span> <span class="st">"2 hours"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_datetime</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    date_breaks <span class="op">=</span> <span class="st">"6 hours"</span>, date_labels <span class="op">=</span> <span class="st">"%Hh %e.%b"</span>,</span></span>
<span class="r-in"><span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2024-02-04 22:00:00"</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    guide <span class="op">=</span> <span class="fu">guide_axis_nested_date</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="guide_axis_nested_date-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ndevln" class="external-link">Alexander Bartel</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://biostats-dev.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

